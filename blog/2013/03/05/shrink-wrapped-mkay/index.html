<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><link rel="icon" sizes="any" type="image/svg+xml" href="/images/favfish.svg"><title>Shrink-wrapped Mkay | einarwh</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta property="og:title" content="Shrink-wrapped Mkay"><meta property="og:url" content="https://einarwh.no/blog/2013/03/05/shrink-wrapped-mkay/"><link rel="stylesheet" href="/bundles/b37fb33da5e4/app.css"></head><body><header><a href="/">einarwh</a><hr></header><h1>Shrink-wrapped Mkay</h1>
<p class="blog-post-date">March 5, 2013</p>
<p>If you’ve been following this blog, you’ll know that there is no point in writing your own custom validation attributes for ASP.NET MVC data validation any more. Instead, you should be using <a href="/blog/2013/02/15/mkay-one-validation-attribute-to-rule-them-all/">Mkay</a>, which allows you to specify arbitrary validation rules for your models in a LISP-like syntax. And now you can actually do it too, since I’ve packaged everything nicely in a <a href="https://www.nuget.org/packages/Mkay">nuget package</a>.</p>
<p>When you install the nuget package in your ASP.NET MVC Application, you’ll find that a few things are added. First, there’s a reference to <em>Mkay.dll</em>, which contains the <strong>Mkay</strong> attribute as well as the code that is executed on the server. Second, in your <em>Scripts</em> folder, you’ll find three JavaScript files: <em>mkay-validation.js</em> (which contains the runtime for the client-side validation in mkay), <em>mkay-parser.js</em> (which is there to support the implementation of <a href="/blog/2013/02/22/self-referential-validation-in-mkay/">eval</a>) and <em>mkay-jquery.js</em> (which hooks up the mkay runtime with unobtrusive jQuery validation). Third, there’s a code file in the <em>App_Start</em> folder called <em>MkayBoot.cs</em>. You may recall that the <strong>Mkay</strong> attribute must be associated with its own data validator class, in order to obtain the name of the property being validated. This happens inside the <strong>Kick</strong> method in the <strong>MkayBoot</strong> class. That method is invoked by means of <a href="https://github.com/davidebbo/WebActivator">WebActivator</a> voodoo some time right after <strong>Application_Start</strong> in <em>global.asax</em> has been invoked. That way, you don’t have to bother with that yourself. For convenience, the <strong>Kick</strong> method also creates a so-called bundle of the Mkay JavaScript files.</p>
<p>Of course, you must remember to reference the Mkay JavaScript bundle in your view somehow, as well as the jQuery validation bundle. You might want to add them to the layout used by your view, for instance. Here’s an example:</p>
<pre class="codehilite"><code class="language-csharp"><span></span><span class="p">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="p">=</span><span class="s">"utf-8"</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="p">=</span><span class="s">"viewport"</span> <span class="n">content</span><span class="p">=</span><span class="s">"width=device-width"</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;</span><span class="n">@ViewBag</span><span class="p">.</span><span class="n">Title</span><span class="p">&lt;/</span><span class="n">title</span><span class="p">&gt;</span>
    <span class="n">@Styles</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="s">"~/Content/css"</span><span class="p">)</span>
    <span class="n">@Scripts</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="s">"~/bundles/modernizr"</span><span class="p">)</span>
    <span class="n">@Scripts</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="s">"~/bundles/jquery"</span><span class="p">)</span>
    <span class="n">@Scripts</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="s">"~/bundles/jqueryval"</span><span class="p">)</span>
    <span class="n">@Scripts</span><span class="p">.</span><span class="n">Render</span><span class="p">(</span><span class="s">"~/bundles/mkay"</span><span class="p">)</span>
<span class="p">&lt;/</span><span class="n">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">body</span><span class="p">&gt;</span>
    <span class="n">@RenderBody</span><span class="p">()</span>
    <span class="n">@RenderSection</span><span class="p">(</span><span class="s">"scripts"</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="k">false</span><span class="p">)</span>
<span class="p">&lt;/</span><span class="n">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">html</span><span class="p">&gt;</span>
</code></pre>
<p>And then you can start using Mkay for your own validation needs. Wee! World domination!</p>
</body></html>